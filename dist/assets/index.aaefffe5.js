import{x as b,ay as I,ao as m,f as C,V as h,az as z,j as d,aA as F,w as f,aB as A,a as S,D as k,c as T,M as g,aC as D,aD as p,o as y,k as w,B as v,C as N,t as O,aE as _,b as j,aF as E,aG as P,aH as R,aI as V,aJ as q,p as G,O as $}from"./index.40f28117.js";import{i as H}from"./isEqual.8a89fd1c.js";function J(t,e="value",a="change",o){const s=F(),u=s==null?void 0:s.emit,n=b({value:t[e]}),r=I(n),l=i=>{n.value=i};return m(()=>{n.value=t[e]}),[C({get(){return n.value},set(i){H(i,r.value)||(n.value=i,h(()=>{u==null||u(a,i,...z(d(o))||[])}))}}),l,r]}function L(t){const e=f(t),a=f(!1);let o;function s(){o&&window.clearInterval(o)}function u(){a.value=!1,s(),o=null}function n(){d(a)||!!o||(a.value=!0,o=setInterval(()=>{d(e)===1?(u(),e.value=t):e.value-=1},1e3))}function r(){e.value=t,u()}function l(){r(),n()}return A(()=>{r()}),{start:n,reset:r,restart:l,clear:s,stop:u,currentCount:e,isStart:a}}const M={value:{type:[Object,Number,String,Array]},count:{type:Number,default:60},beforeStartFunc:{type:Function,default:null}},U=S({name:"CountButton",components:{Button:k},props:M,setup(t){const e=f(!1),{currentCount:a,isStart:o,start:s,reset:u}=L(t.count),{t:n}=T(),r=C(()=>d(o)?n("component.countdown.sendText",[d(a)]):n("component.countdown.normalText"));m(()=>{t.value===void 0&&u()});async function l(){const{beforeStartFunc:c}=t;if(c&&D(c)){e.value=!0;try{await c()&&s()}finally{e.value=!1}}else s()}return{handleStart:l,currentCount:a,loading:e,getButtonText:r,isStart:o}}});function x(t,e,a,o,s,u){const n=p("Button");return y(),w(n,_(t.$attrs,{disabled:t.isStart,onClick:t.handleStart,loading:t.loading}),{default:v(()=>[N(O(t.getButtonText),1)]),_:1},16,["disabled","onClick","loading"])}var B=g(U,[["render",x]]);const K={value:{type:String},size:{type:String,validator:t=>["default","large","small"].includes(t)},count:{type:Number,default:60},sendCodeApi:{type:Function,default:null}},Q=S({name:"CountDownInput",components:{CountButton:B},inheritAttrs:!1,props:K,setup(t){const{prefixCls:e}=j("countdown-input"),[a]=J(t);return{prefixCls:e,state:a}}});function W(t,e,a,o,s,u){const n=p("CountButton"),r=p("a-input");return y(),w(r,_(t.$attrs,{class:t.prefixCls,size:t.size,value:t.state}),E({addonAfter:v(()=>[G(n,{size:t.size,count:t.count,value:t.state,beforeStartFunc:t.sendCodeApi},null,8,["size","count","value","beforeStartFunc"])]),_:2},[P(Object.keys(t.$slots).filter(l=>l!=="addonAfter"),l=>({name:l,fn:v(c=>[R(t.$slots,l,V(q(c||{})))])}))]),1040,["class","size","value"])}var X=g(Q,[["render",W]]);const tt=$(X);$(B);export{tt as C,J as u};
