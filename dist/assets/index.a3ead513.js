import{c as te,ao as I,j as l,bo as ue,a as w,br as de,cC as fe,p as M,ec as pe,ed as ge,ci as me,bw as he,bx as ye,bT as be,w as m,ee as ve,f as H,L as ne,K as Ce,ai as oe,V as B,M as E,aD as y,c3 as Me,o as v,k as O,B as g,y as He,i as V,bB as Fe,aH as $,bz as Se,bd as ke,b as le,F as Be,l as z,r as $e,C as q,t as X,aE as W,dw as Oe,bS as Pe,au as A,aA as U,aC as ae,eb as Te,aF as K,aG as Q,aI as Z,aJ as x,x as se,az as L,cF as we,dz as re,aB as De,O as Re}from"./index.40f28117.js";import{u as Ne}from"./useWindowSizeFn.8d01d8dc.js";import{F as We,a as Ee}from"./FullscreenOutlined.0e9dbd72.js";import{i as _e}from"./isEqual.8a89fd1c.js";const{t:ee}=te(),je={visible:{type:Boolean},scrollTop:{type:Boolean,default:!0},height:{type:Number},minHeight:{type:Number},draggable:{type:Boolean,default:!0},centered:{type:Boolean},cancelText:{type:String,default:ee("common.cancelText")},okText:{type:String,default:ee("common.okText")},closeFunc:Function},G=Object.assign({},je,{defaultFullscreen:{type:Boolean},canFullscreen:{type:Boolean,default:!0},wrapperFooterOffset:{type:Number,default:0},helpMessage:[String,Array],useWrapper:{type:Boolean,default:!0},loading:{type:Boolean},loadingTip:{type:String},showCancelBtn:{type:Boolean,default:!0},showOkBtn:{type:Boolean,default:!0},wrapperProps:Object,afterClose:Function,bodyStyle:Object,closable:{type:Boolean,default:!0},closeIcon:Object,confirmLoading:{type:Boolean},destroyOnClose:{type:Boolean},footer:Object,getContainer:Function,mask:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},keyboard:{type:Boolean,default:!0},maskStyle:Object,okType:{type:String,default:"primary"},okButtonProps:Object,cancelButtonProps:Object,title:{type:String},visible:{type:Boolean},width:[String,Number],wrapClassName:{type:String},zIndex:{type:Number}});function Le(e){const a=(o,i)=>getComputedStyle(o)[i],c=o=>{if(!o)return;o.setAttribute("data-drag",l(e.draggable));const i=o.querySelector(".ant-modal-header"),t=o.querySelector(".ant-modal");!i||!t||!l(e.draggable)||(i.style.cursor="move",i.onmousedown=n=>{if(!n)return;const p=n.clientX,u=n.clientY,d=document.body.clientWidth,f=document.documentElement.clientHeight,h=t.offsetWidth,C=t.offsetHeight,F=t.offsetLeft,S=d-t.offsetLeft-h,k=t.offsetTop,_=f-t.offsetTop-C,P=a(t,"left"),D=a(t,"top");let R=+P,N=+D;P.includes("%")?(R=+document.body.clientWidth*(+P.replace(/%/g,"")/100),N=+document.body.clientHeight*(+D.replace(/%/g,"")/100)):(R=+P.replace(/px/g,""),N=+D.replace(/px/g,"")),document.onmousemove=function(j){let s=j.clientX-p,b=j.clientY-u;-s>F?s=-F:s>S&&(s=S),-b>k?b=-k:b>_&&(b=_),t.style.cssText+=`;left:${s+R}px;top:${b+N}px;`},document.onmouseup=()=>{document.onmousemove=null,document.onmouseup=null}})},r=()=>{const o=document.querySelectorAll(".ant-modal-wrap");for(const i of Array.from(o)){if(!i)continue;const t=a(i,"display"),n=i.getAttribute("data-drag");t!=="none"&&(n===null||l(e.destroyOnClose))&&c(i)}};I(()=>{!l(e.visible)||!l(e.draggable)||ue(()=>{r()},30)})}function Ve(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!me(e)}var Ie=w({name:"Modal",inheritAttrs:!1,props:G,emits:["cancel"],setup(e,{slots:a}){const{visible:c,draggable:r,destroyOnClose:o}=de(e),i=fe();return Le({visible:c,destroyOnClose:o,draggable:r}),()=>{let t;const n={...l(i),...e};return M(ge,n,Ve(t=pe(a))?t:{default:()=>[t]})}}});const ie=Symbol();function Ae(e){return he(e,ie)}function dt(){return ye(ie)}const ze={loading:{type:Boolean},useWrapper:{type:Boolean,default:!0},modalHeaderHeight:{type:Number,default:57},modalFooterHeight:{type:Number,default:74},minHeight:{type:Number,default:200},height:{type:Number},footerOffset:{type:Number,default:0},visible:{type:Boolean},fullScreen:{type:Boolean},loadingTip:{type:String}},qe=w({name:"ModalWrapper",components:{ScrollContainer:be},inheritAttrs:!1,props:ze,emits:["height-change","ext-height"],setup(e,{emit:a}){const c=m(null),r=m(null),o=m(0),i=m(0);let t=0;Ne(u.bind(null,!1)),ve(r,()=>{u()},{attributes:!0,subtree:!0}),Ae({redoModalHeight:u});const n=H(()=>({minHeight:`${e.minHeight}px`,[e.fullScreen?"height":"maxHeight"]:`${l(o)}px`}));I(()=>{e.useWrapper&&u()}),ne(()=>e.fullScreen,d=>{u(),d?i.value=o.value:o.value=i.value}),Ce(()=>{const{modalHeaderHeight:d,modalFooterHeight:f}=e;a("ext-height",d+f)}),oe(()=>{});async function p(){B(()=>{var f;const d=l(c);!d||(f=d==null?void 0:d.scrollTo)==null||f.call(d,0)})}async function u(){if(!e.visible)return;const d=l(c);if(!d)return;const f=d.$el.parentElement;if(!!f){f.style.padding="0",await B();try{const h=f.parentElement&&f.parentElement.parentElement;if(!h)return;const C=getComputedStyle(h).top,F=Number.parseInt(C);let S=window.innerHeight-F*2+(e.footerOffset||0)-e.modalFooterHeight-e.modalHeaderHeight;F<40&&(S-=26),await B();const k=l(r);if(!k)return;await B(),t=k.scrollHeight,e.fullScreen?o.value=window.innerHeight-e.modalFooterHeight-e.modalHeaderHeight-28:o.value=e.height?e.height:t>S?S:t,a("height-change",l(o))}catch(h){console.log(h)}}}return{wrapperRef:c,spinRef:r,spinStyle:n,scrollTop:p,setModalHeight:u}}}),Xe=["loading-tip"];function Ye(e,a,c,r,o,i){const t=y("ScrollContainer"),n=Me("loading");return v(),O(t,{ref:"wrapperRef"},{default:g(()=>[He((v(),V("div",{ref:"spinRef",style:Fe(e.spinStyle),"loading-tip":e.loadingTip},[$(e.$slots,"default")],12,Xe)),[[n,e.loading]])]),_:3},512)}var Ue=E(qe,[["render",Ye]]);const Ge=w({name:"ModalClose",components:{Tooltip:Se,FullscreenExitOutlined:We,FullscreenOutlined:Ee,CloseOutlined:ke},props:{canFullscreen:{type:Boolean,default:!0},fullScreen:{type:Boolean}},emits:["cancel","fullscreen"],setup(e,{emit:a}){const{prefixCls:c}=le("basic-modal-close"),{t:r}=te(),o=H(()=>[c,`${c}--custom`,{[`${c}--can-full`]:e.canFullscreen}]);function i(n){a("cancel",n)}function t(n){n==null||n.stopPropagation(),n==null||n.preventDefault(),a("fullscreen")}return{t:r,getClass:o,prefixCls:c,handleCancel:i,handleFullScreen:t}}});function Je(e,a,c,r,o,i){const t=y("FullscreenExitOutlined"),n=y("Tooltip"),p=y("FullscreenOutlined"),u=y("CloseOutlined");return v(),V("div",{class:$e(e.getClass)},[e.canFullscreen?(v(),V(Be,{key:0},[e.fullScreen?(v(),O(n,{key:0,title:e.t("component.modal.restore"),placement:"bottom"},{default:g(()=>[M(t,{role:"full",onClick:e.handleFullScreen},null,8,["onClick"])]),_:1},8,["title"])):(v(),O(n,{key:1,title:e.t("component.modal.maximize"),placement:"bottom"},{default:g(()=>[M(p,{role:"close",onClick:e.handleFullScreen},null,8,["onClick"])]),_:1},8,["title"]))],64)):z("",!0),M(n,{title:e.t("component.modal.close"),placement:"bottom"},{default:g(()=>[M(u,{onClick:e.handleCancel},null,8,["onClick"])]),_:1},8,["title"])],2)}var Ke=E(Ge,[["render",Je]]);const Qe=w({name:"BasicModalFooter",props:G,emits:["ok","cancel"],setup(e,{emit:a}){function c(o){a("ok",o)}function r(o){a("cancel",o)}return{handleOk:c,handleCancel:r}}});function Ze(e,a,c,r,o,i){const t=y("a-button");return v(),V("div",null,[$(e.$slots,"insertFooter"),e.showCancelBtn?(v(),O(t,W({key:0},e.cancelButtonProps,{onClick:e.handleCancel}),{default:g(()=>[q(X(e.cancelText),1)]),_:1},16,["onClick"])):z("",!0),$(e.$slots,"centerFooter"),e.showOkBtn?(v(),O(t,W({key:1,type:e.okType,onClick:e.handleOk,loading:e.confirmLoading},e.okButtonProps),{default:g(()=>[q(X(e.okText),1)]),_:1},16,["type","onClick","loading"])):z("",!0),$(e.$slots,"appendFooter")])}var xe=E(Qe,[["render",Ze]]);const et=w({name:"BasicModalHeader",components:{BasicTitle:Oe},props:{helpMessage:{type:[String,Array]},title:{type:String}},emits:["dblclick"]});function tt(e,a,c,r,o,i){const t=y("BasicTitle");return v(),O(t,{helpMessage:e.helpMessage},{default:g(()=>[q(X(e.title),1)]),_:1},8,["helpMessage"])}var nt=E(et,[["render",tt]]);function ot(e){const a=m(!1),c=H(()=>{const o=l(e.wrapClassName)||"";return l(a)?`fullscreen-modal ${o} `:l(o)});function r(o){o&&o.stopPropagation(),a.value=!l(a)}return{getWrapClassName:c,handleFullScreen:r,fullScreenRef:a}}const lt=w({name:"BasicModal",components:{Modal:Ie,ModalWrapper:Ue,ModalClose:Ke,ModalFooter:xe,ModalHeader:nt},inheritAttrs:!1,props:G,emits:["visible-change","height-change","cancel","ok","register","update:visible"],setup(e,{emit:a,attrs:c}){const r=m(!1),o=m(null),i=m(null),{prefixCls:t}=le("basic-modal"),n=m(0),p={setModalProps:P,emitVisible:void 0,redoModalHeight:()=>{B(()=>{l(i)&&l(i).setModalHeight()})}},u=U();u&&a("register",p,u.uid);const d=H(()=>({...e,...l(o)})),{handleFullScreen:f,getWrapClassName:h,fullScreenRef:C}=ot({modalWrapperRef:i,extHeightRef:n,wrapClassName:Pe(d.value,"wrapClassName")}),F=H(()=>({...{...l(d),visible:l(r),okButtonProps:void 0,cancelButtonProps:void 0,title:void 0},wrapClassName:l(h)})),S=H(()=>{const s={...c,...l(d),visible:l(r),wrapClassName:l(h)};return l(C)?A(s,["height","title"]):A(s,"title")}),k=H(()=>{if(!l(C))return l(F).height});I(()=>{r.value=!!e.visible,C.value=!!e.defaultFullscreen}),ne(()=>l(r),s=>{var b;a("visible-change",s),a("update:visible",s),u&&((b=p.emitVisible)==null||b.call(p,s,u.uid)),B(()=>{e.scrollTop&&s&&l(i)&&l(i).scrollTop()})},{immediate:!1});async function _(s){var b,J;if(s==null||s.stopPropagation(),!((J=(b=s.target)==null?void 0:b.classList)!=null&&J.contains(t+"-close--custom"))){if(e.closeFunc&&ae(e.closeFunc)){const ce=await e.closeFunc();r.value=!ce;return}r.value=!1,a("cancel",s)}}function P(s){o.value=Te(l(o)||{},s),Reflect.has(s,"visible")&&(r.value=!!s.visible),Reflect.has(s,"defaultFullscreen")&&(C.value=!!s.defaultFullscreen)}function D(s){a("ok",s)}function R(s){a("height-change",s)}function N(s){n.value=s}function j(s){!e.canFullscreen||(s.stopPropagation(),f(s))}return{handleCancel:_,getBindValue:S,getProps:F,handleFullScreen:f,fullScreenRef:C,getMergeProps:d,handleOk:D,visibleRef:r,omit:A,modalWrapperRef:i,handleExtHeight:N,handleHeightChange:R,handleTitleDbClick:j,getWrapperHeight:k}}});function at(e,a,c,r,o,i){const t=y("ModalClose"),n=y("ModalHeader"),p=y("ModalFooter"),u=y("ModalWrapper"),d=y("Modal");return v(),O(d,W(e.getBindValue,{onCancel:e.handleCancel}),K({default:g(()=>[M(u,W({useWrapper:e.getProps.useWrapper,footerOffset:e.wrapperFooterOffset,fullScreen:e.fullScreenRef,ref:"modalWrapperRef",loading:e.getProps.loading,"loading-tip":e.getProps.loadingTip,minHeight:e.getProps.minHeight,height:e.getWrapperHeight,visible:e.visibleRef,modalFooterHeight:e.footer!==void 0&&!e.footer?0:void 0},e.omit(e.getProps.wrapperProps,"visible","height","modalFooterHeight"),{onExtHeight:e.handleExtHeight,onHeightChange:e.handleHeightChange}),{default:g(()=>[$(e.$slots,"default")]),_:3},16,["useWrapper","footerOffset","fullScreen","loading","loading-tip","minHeight","height","visible","modalFooterHeight","onExtHeight","onHeightChange"])]),_:2},[e.$slots.closeIcon?void 0:{name:"closeIcon",fn:g(()=>[M(t,{canFullscreen:e.getProps.canFullscreen,fullScreen:e.fullScreenRef,onCancel:e.handleCancel,onFullscreen:e.handleFullScreen},null,8,["canFullscreen","fullScreen","onCancel","onFullscreen"])]),key:"0"},e.$slots.title?void 0:{name:"title",fn:g(()=>[M(n,{helpMessage:e.getProps.helpMessage,title:e.getMergeProps.title,onDblclick:e.handleTitleDbClick},null,8,["helpMessage","title","onDblclick"])]),key:"1"},e.$slots.footer?void 0:{name:"footer",fn:g(()=>[M(p,W(e.getBindValue,{onOk:e.handleOk,onCancel:e.handleCancel}),K({_:2},[Q(Object.keys(e.$slots),f=>({name:f,fn:g(h=>[$(e.$slots,f,Z(x(h||{})))])}))]),1040,["onOk","onCancel"])]),key:"2"},Q(Object.keys(e.omit(e.$slots,"default")),f=>({name:f,fn:g(h=>[$(e.$slots,f,Z(x(h||{})))])}))]),1040,["onCancel"])}var st=E(lt,[["render",at]]);const T=se({}),Y=se({});function ft(){const e=m(null),a=m(!1),c=m("");function r(t,n){if(!U())throw new Error("useModal() can only be used inside setup() or functional components!");c.value=n,oe(()=>{e.value=null,a.value=!1,T[l(c)]=null}),!(l(a)&&we()&&t===l(e))&&(e.value=t,a.value=!0,t.emitVisible=(p,u)=>{Y[u]=p})}const o=()=>{const t=l(e);return t||re("useModal instance is undefined!"),t},i={setModalProps:t=>{var n;(n=o())==null||n.setModalProps(t)},getVisible:H(()=>Y[~~l(c)]),redoModalHeight:()=>{var t,n;(n=(t=o())==null?void 0:t.redoModalHeight)==null||n.call(t)},openModal:(t=!0,n,p=!0)=>{var f;if((f=o())==null||f.setModalProps({visible:t}),!n)return;const u=l(c);if(p){T[u]=null,T[u]=L(n);return}_e(L(T[u]),L(n))||(T[u]=L(n))},closeModal:()=>{var t;(t=o())==null||t.setModalProps({visible:!1})}};return[r,i]}const pt=e=>{const a=m(null),c=U(),r=m(""),o=()=>{const t=l(a);return t||re("useModalInner instance is undefined!"),t},i=(t,n)=>{De(()=>{a.value=null}),r.value=n,a.value=t,c==null||c.emit("register",t,n)};return I(()=>{const t=T[l(r)];!t||!e||!ae(e)||B(()=>{e(t)})}),[i,{changeLoading:(t=!0)=>{var n;(n=o())==null||n.setModalProps({loading:t})},getVisible:H(()=>Y[~~l(r)]),changeOkLoading:(t=!0)=>{var n;(n=o())==null||n.setModalProps({confirmLoading:t})},closeModal:()=>{var t;(t=o())==null||t.setModalProps({visible:!1})},setModalProps:t=>{var n;(n=o())==null||n.setModalProps(t)},redoModalHeight:()=>{var n;const t=(n=o())==null?void 0:n.redoModalHeight;t&&t()}}]},gt=Re(st);export{gt as B,ft as a,pt as b,dt as u};
